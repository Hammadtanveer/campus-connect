# Fix for Broken PDF Uploads

## Issue
Users reported that uploaded PDFs were not opening, showing `ERR_INVALID_RESPONSE`.
The URL contained spaces and parentheses (e.g., `%20`, `%28`), which caused issues with Cloudinary's delivery, especially when combined with `resource_type: "auto"`.

## Root Cause
1.  The filename sanitization regex allowed some characters that might cause issues or was not being applied correctly due to `use_filename = true` potentially overriding the `public_id` behavior in some contexts.
2.  The URL generated by Cloudinary contained encoded characters that, when accessed via the `raw` endpoint (if Cloudinary decided it was raw) or `image` endpoint, caused a mismatch or delivery failure.

## Fix Applied
Modified `app/src/main/java/com/example/campusconnect/data/repository/NotesRepository.kt`:
1.  **Stricter Sanitization**: Changed the regex to `[^a-zA-Z0-9]`. This replaces ALL non-alphanumeric characters (including spaces, parentheses, dots, hyphens) with underscores. This ensures the `public_id` is extremely clean.
2.  **Removed `use_filename`**: Commented out `"use_filename" to true`. This forces Cloudinary to use the provided `public_id` strictly, avoiding any ambiguity from the original filename.

## Action Required for Users
*   **For the broken note**: The existing note with the broken URL cannot be fixed remotely because the file on Cloudinary is likely stored with a problematic ID or type. **Please delete the note and re-upload it.**
*   **For new uploads**: The new logic will ensure all future uploads have clean, safe URLs that will open correctly.

